{"version":3,"file":"static/webpack/static/development/pages/index.js.39e2b57cc2b924dda6a7.hot-update.js","sources":["webpack:///./utils/useTodayStats.js"],"sourcesContent":["import { useState, useEffect } from 'react'\nimport axios from 'axios'\n\nconst capitalize = str => str.charAt(0).toUpperCase() + str.toLowerCase().slice(1)\nconst parseCn = str => {\n  return str === 'usa' || str === 'Usa'\n    ? 'USA' \n      : str === 'Uk' || str === 'England' || str === 'United Kingdom' || str == 'great britain'\n    ? 'UK' \n    : str.toLowerCase();\n}\n\nfunction getCountry(list){\n  return function(queryCountry) {\n    return list.reduce((a,c) => c.country === queryCountry ? c : a, {})\n  }\n}\n\nasync function currentCountry(){\n  return await axios\n    .get('https://extreme-ip-lookup.com/json/')\n    .then(res => res.data.country)\n    .catch(e => 'israel')\n}\n\nfunction useTodayStats(url, country) {\n  const [todayStats, setStats] = useState();\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState(false);\n\n  useEffect(() => {\n\n    async function fetchData() {\n      setLoading(true)\n      setError()\n      let searchCountry = country || await currentCountry();\n\n      const parsedCountry = parseCn(searchCountry);\n      const URL = url + 'today/' + searchCountry.toLowerCase()\n      // const URL = url + (country === 'world' ? '' : searchCountry)\n      try {\n        // const data = await fetch(URL)\n        //     .then(res => res.json())\n        //     .catch(err => setError(err))\n        const { data } = await axios.get(URL)\n        console.log(data);\n        const relevant = {\n          active: data.active,\n          cases: data.cases,\n          todayCases: data.todayCases,\n          recovered: data.recovered,\n          deaths: data.deaths,\n          country: data.country\n        }\n        setStats(relevant)\n        setLoading(false)\n       } catch(e) {\n        console.log('error getting today data', e);\n        setError(e)\n      }\n    }\n    fetchData();\n  }, [country])\n  return {\n    todayStats, loading, error\n  }\n}\n\nexport default useTodayStats;\n"],"mappings":";;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AAAA;AAAA;AACA;AAAA;AACA;AAKA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AAAA;AACA;AAAA;AACA;AALA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAMA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AACA;AAIA;AAEA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AACA;AACA;AAFA;AACA;AADA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AACA;AADA;AAAA;AACA;AADA;AAGA;AAEA;AACA;AACA;AAPA;AAAA;AAAA;AACA;AADA;AAAA;AAYA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AANA;AAQA;AACA;AAvBA;AAAA;AACA;AADA;AAAA;AAAA;AAyBA;AACA;AACA;AA3BA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AA4BA;AACA;AACA;AACA;AAAA;AAAA;AADA;AAGA;AACA;AACA;;;;A","sourceRoot":""}