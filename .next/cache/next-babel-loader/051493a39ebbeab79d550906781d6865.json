{"ast":null,"code":"import { useState, useEffect } from 'react';\nimport axios from 'axios';\n\nconst capitalize = str => str.charAt(0).toUpperCase() + str.toLowerCase().slice(1);\n\nconst parseCn = str => {\n  return str === 'usa' || str === 'Usa' || str === 'United States' ? 'USA' : str === 'Uk' || str === 'England' || str === 'United Kingdom' || str == 'great britain' ? 'UK' : str.toLowerCase();\n};\n\nfunction getCountry(list) {\n  return function (queryCountry) {\n    return list.reduce((a, c) => c.country === queryCountry ? c : a, {});\n  };\n}\n\nasync function currentCountry() {\n  return await axios.get('https://extreme-ip-lookup.com/json/').then(res => res.data.country).catch(e => 'israel');\n}\n\nfunction useTodayStats(url, country) {\n  const {\n    0: todayStats,\n    1: setStats\n  } = useState();\n  const {\n    0: loading,\n    1: setLoading\n  } = useState(false);\n  const {\n    0: error,\n    1: setError\n  } = useState(false);\n  useEffect(() => {\n    async function fetchData() {\n      setLoading(true);\n      setError();\n      let searchCountry = country || (await currentCountry());\n      const parsedCountry = parseCn(searchCountry);\n      const URL = url + 'today/' + parsedCountry.toLowerCase();\n\n      try {\n        const {\n          data\n        } = await axios.get(URL);\n        const relevant = {\n          active: data.active,\n          cases: data.cases,\n          todayCases: data.todayCases,\n          recovered: data.recovered,\n          deaths: data.deaths,\n          country: data.country\n        };\n        setStats(relevant);\n        setLoading(false);\n      } catch (e) {\n        setError(e);\n      }\n    }\n\n    fetchData();\n  }, [country]);\n  return {\n    todayStats,\n    loading,\n    error\n  };\n}\n\nexport default useTodayStats;","map":null,"metadata":{},"sourceType":"module"}